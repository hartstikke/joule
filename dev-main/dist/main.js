(function(i){typeof define=="function"&&define.amd?define(i):i()})(function(){"use strict";function i(){function F(){document.querySelectorAll(".linked-input, .linked-range").forEach(a=>{a.addEventListener("input",m),m.call(a)})}function m(){const o=this.getAttribute("data-linked-input")||this.getAttribute("data-linked-range");if(document.getElementById(o)&&this.classList.contains("linked-range")){const r=(this.value-this.min)/(this.max-this.min)*100;this.style.background=`linear-gradient(to right, #A0E8E3 0%, #A0E8E3 ${r}%, #F3F3F3 ${r}%, #F3F3F3 100%)`}}F(),document.addEventListener("input",function(o){const a=o.target,r=a.dataset.linkedInput||a.dataset.linkedRange;r&&document.querySelectorAll(`[data-linked-input="${r}"], [data-linked-range="${r}"]`).forEach(c=>{c.value=a.value,m.call(c)})});const p=document.getElementById("bikeRetailPrice"),k=document.getElementById("form-button"),L=async o=>{o.preventDefault();let a=parseFloat(document.getElementById("bikeRetailPrice").value)/1.21,r=parseFloat(document.getElementById("accessoriesRetailPrice").value)/1.21,b=parseFloat(document.querySelector('input[name="yearlyMaintenanceFee"]:checked').value)/1.21,c=parseFloat(document.getElementById("commuteKilometers").value),E=parseFloat(document.getElementById("commuteWeeklyFrequency").value),h=document.querySelector('input[name="financingMethod"]:checked').value,v=document.querySelector('input[name="civilStatus"]:checked').value,q=parseFloat(document.getElementById("dependentChildren").value),C=parseFloat(document.querySelector("#statute-selector .w--tab-active #grossSalary").value),M=document.querySelector("#statute-selector .w--tab-active .radio--pc:checked").value,I=parseFloat(document.querySelector('input[name="durationInMonths"]:checked').value),P=parseFloat(document.querySelector('input[name="durationInMonths"]:checked').getAttribute("data-residualValue"));const n={financingMethod:h,grossSalary:C,workingRegimePercent:1,civilStatus:v,workingSpouse:!0,dependentChildren:q,commuteKilometers:c,commuteWeeklyFrequency:E,computeModel:M,computeLeaseRateDto:{bikeRetailPrice:a,accessoriesRetailPrice:r,discountRate:0,interestRate:.077,durationInMonths:I,insurancePremium:.035,deliveryCost:50,assemblyCost:117,residualValue:P,yearlyAdminFee1:36,yearlyAdminFee2:18.33,yearlyMaintenanceFee:b}};console.log(n);try{const e=await(await fetch("https://api.offr.be/partners/joule/calculate",{method:"POST",headers:{"Content-Type":"application/json","x-offr-api-key":"clomvufdi000408i8f7i0gu6t"},body:JSON.stringify(n)})).json();e&&document.querySelector(".calculator_default").classList.add("hide"),console.log(e),document.querySelector(".calculator_result").style.display="block",window.scrollTo({top:document.getElementById("calculator_result-wrapper").offsetTop,behavior:"smooth"});const T=document.querySelector('input[name="durationInMonths"]:checked').value,R={12:40,24:33,36:16,48:16}[T]/100||0,t=(l,d,w)=>{if(w)document.querySelectorAll(`[data-result="${l}"`).forEach(x=>x.innerText=`${x.hasAttribute("data-prefix")?"\u20AC"+d:d}`);else{const y=document.querySelector(`[data-result="${l}"`);y&&(y.innerText=`${y.hasAttribute("data-prefix")?"\u20AC"+d:d}`)}},g=e.leasePrice.monthlyLeasePrice*1.21;document.querySelectorAll('[data-result="monthlyLeasePrice"]').forEach(l=>l.innerText=g.toFixed(0)),document.querySelector('[data-result="maintenanceCost"]').innerText="\u20AC "+(e.leasePrice.maintenanceCost*12*1.21).toFixed(0),document.querySelector('[data-result="servicePackage"]').innerText=document.querySelector('input[name="yearlyMaintenanceFee"]:checked').getAttribute("data-label"),document.querySelector('[data-result="durationInMonths"]').innerText=document.querySelector('input[name="durationInMonths"]:checked').getAttribute("data-label").split(" ")[0],t("beforeSocialSecurity","- \u20AC"+Math.abs(e.beforeLeaseSalary.employerCosts.socialSecurityStructuralReduction.toFixed(0))),t("afterSocialSecurity","- \u20AC"+Math.abs(e.afterLeaseSalary.employerCosts.socialSecurityStructuralReduction.toFixed(0))),t("beforeOtherExpenses",`- \u20AC${e.beforeLeaseSalary.employerCosts.otherExpenses.toFixed(0)}`),t("afterOtherExpenses",`- \u20AC${e.afterLeaseSalary.employerCosts.otherExpenses.toFixed(0)}`);const s=e.beforeLeaseSalary.employerCosts.otherExpenses+e.beforeLeaseSalary.employerCosts.socialSecurityContributions+e.beforeLeaseSalary.employerCosts.socialSecurityStructuralReduction,u=e.afterLeaseSalary.employerCosts.otherExpenses+e.afterLeaseSalary.employerCosts.socialSecurityContributions+e.afterLeaseSalary.employerCosts.socialSecurityStructuralReduction;let f=(s-u)/12;h==="BONUS"&&(f=s-u,document.querySelectorAll('[data-bonus="show"]').forEach(l=>l.classList.remove("hide")),document.querySelectorAll('[data-bonus="hide"]').forEach(l=>l.classList.add("hide"))),t("advantage",f.toFixed(0),!0),t("recoup",(g-f).toFixed(0),!0),t("beforeEmployerTotal",`- \u20AC${s.toFixed(0)}`),t("afterEmployerTotal",`- \u20AC${u.toFixed(0)}`),t("savedTotalYearly",`\u20AC${(s-u).toFixed(0)}`),t("beforeLeaseSalaryGross","\u20AC"+e.beforeLeaseSalary.grossSalary.toFixed(0)),t("afterLeaseSalaryGross","\u20AC"+e.afterLeaseSalary.grossSalary.toFixed(0)),t("beforeSocialSecurityContributions","- \u20AC"+e.beforeLeaseSalary.socialSecurityContributions.toFixed(0)),t("beforeSpecialSocialSecurityContributions","- \u20AC"+e.beforeLeaseSalary.specialSocialSecurityContributions.toFixed(0)),t("afterSocialSecurityContributions","- \u20AC"+e.afterLeaseSalary.socialSecurityContributions.toFixed(0)),t("afterSpecialSocialSecurityContributions","- \u20AC"+e.afterLeaseSalary.specialSocialSecurityContributions.toFixed(0)),t("beforeWorkBonus","\u20AC"+e.beforeLeaseSalary.workBonus.toFixed(0)),t("afterWorkBonus","\u20AC"+e.afterLeaseSalary.workBonus.toFixed(0)),t("beforeTaxableIncome","\u20AC"+e.beforeLeaseSalary.taxableIncome.toFixed(0)),t("afterTaxableIncome","\u20AC"+e.afterLeaseSalary.taxableIncome.toFixed(0)),t("beforeIncomeTax","- \u20AC"+e.beforeLeaseSalary.incomeTaxes.toFixed(0)),t("afterIncomeTax","- \u20AC"+e.afterLeaseSalary.incomeTaxes.toFixed(0)),t("beforeLeaseSalaryNet","\u20AC"+e.beforeLeaseSalary.monthlyNetSalary.toFixed(0)),t("afterLeaseSalaryNet","\u20AC"+e.afterLeaseSalary.monthlyNetSalary.toFixed(0)),t("monthlyNet","\u20AC"+Math.abs(e.diffs.monthlyNet.toFixed(2))),document.querySelector('[data-result="totalNet"]').innerText="\u20AC "+Math.abs(e.diffs.totalNet.toFixed(0)),document.querySelector('[data-result="residualValue"]').innerText="\u20AC "+(n.computeLeaseRateDto.bikeRetailPrice*R*1.21).toFixed(0);let A=document.querySelector("#fietsVergoeding").value||.27,$=Math.abs(e.leasePrice.totalLeasePrice*1.21)-Math.abs(e.diffs.totalNet)-Math.abs(n.computeLeaseRateDto.bikeRetailPrice*n.computeLeaseRateDto.residualValue);document.querySelector('[data-result="packageValue"]').innerText="\u20AC "+Math.abs((e.leasePrice.totalLeasePrice*1.21).toFixed(0)),document.querySelector('[data-result="packageValueCalc"]').innerText="\u20AC "+$.toFixed(0),document.querySelector('[data-result="potentialMonthlyBikeAllowance"]').innerText="\u20AC "+Math.min((4*(n.commuteKilometers*2)*n.commuteWeeklyFrequency*A).toFixed(0),625)}catch(S){console.error(`Error getting output: ${S}`),window.alert(`Error getting output: ${S}`)}};k.addEventListener("click",L),p.addEventListener("blur",o=>{let a=o.currentTarget.value;console.log(a),a<605&&setTimeout(()=>{p.value=605},50)}),document.addEventListener("change",function(o){if(o.target.type==="radio"&&o.target.closest(".calculator_radio-block")){const a=o.target.name;document.querySelectorAll(`.calculator_radio-block input[type="radio"][name="${a}"]`).forEach(function(r){r.closest(".calculator_radio-block").classList.remove("checked")}),o.target.closest(".calculator_radio-block").classList.add("checked")}})}i()});
